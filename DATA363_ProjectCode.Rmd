---
title: "DATA363_ResearchProject"
author: "Micaila Marcelle"
date: "2025-04-09"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

################################################################################
FOLLOWING CODE IS USED FOR GENERATING THE TOTAL DISTANCE BAR CHARTS
################################################################################

```{r}
library(tidyverse)
races <- read_csv('https://docs.google.com/spreadsheets/d/1j5ezobC_HXnCS8S18cZg6zQaJqisjrUvqVK8b8x3v08/gviz/tq?tqx=out:csv')
races <- races[1:13]
races
```

First, we need to clean up the data after reading it in. Some of the numeric columns were read as strings, so those columns need to be fixed.
```{r}
races$`Individual Winner Monetary Prize - MEN` <- gsub("^€", "",  races$`Individual Winner Monetary Prize - MEN`)
races$`Total Prize Pool - MEN` <- gsub("^€", "",  races$`Total Prize Pool - MEN`)
races$`Individual Winner Monetary Prize - WOMEN` <- gsub("^€", "",  races$`Individual Winner Monetary Prize - WOMEN`)
races$`Total Prize Pool - WOMEN` <- gsub("^€", "",  races$`Total Prize Pool - WOMEN`)
races$`Total Distance - MEN`<- gsub("km", "", races$`Total Distance - MEN`)
races$`Total Distance - WOMEN`<- gsub("km", "", races$`Total Distance - WOMEN`)
races$`Total Distance - MEN` <- as.double(races$`Total Distance - MEN`)
races$`Total Distance - WOMEN` <- as.double(races$`Total Distance - WOMEN`)
races$`Individual Winner Monetary Prize - MEN` <- as.numeric(gsub(',', '', races$`Individual Winner Monetary Prize - MEN`))
races$`Individual Winner Monetary Prize - WOMEN` <- as.numeric(gsub(',', '', races$`Individual Winner Monetary Prize - WOMEN`))
races$`Total Prize Pool - MEN` <- as.numeric(gsub(',', '', races$`Total Prize Pool - MEN`))
races$`Total Prize Pool - WOMEN` <- as.numeric(gsub(',', '', races$`Total Prize Pool - WOMEN`))
races$`Final Winner Time - MEN` <- as.numeric(races$`Final Winner Time - MEN`)
races$`Final Winner Time - WOMEN` <- as.numeric(races$`Final Winner Time - WOMEN`)
```


```{r}
summary(races)
```

First, the mean total distance for each year for the women's races is calculated, with these values being entered in manually for now. Note that all of these values are in kilometers, and that the races are separated by category. 
```{r}
wMeanDist_df = data.frame(Year=c(2016:2024))
wMeanDist_df$DistStage = c(0)
wMeanDist_df$DistGT = c(0)
wMeanDist_df$DistOD = c(0)
wMeanDist_df$RaceCount = c(0)

for(i in 0:8) {
  wMeanDist_df$DistStage[9-i] <- mean(races[races$Year == (2024-i) & races$Type == 'Stage',]$`Total Distance - WOMEN`)
  wMeanDist_df$DistGT[9-i] <- mean(races[races$Year == (2024-i) & races$Type == 'Grand Tour',]$`Total Distance - WOMEN`)
  wMeanDist_df$RaceCount[9-i] <- nrow(races[races$Year == 2024-i,])
  if(i >= 7) {
    wMeanDist_df$DistOD[9-i] <- mean(races[races$Year == (2024-i) & (races$Type == 'One-Day' | races$Race == 'Tour of Guangxi' | races$Race == 'La Vuelta de Espana'),]$`Total Distance - WOMEN`)
  } else {
    wMeanDist_df$DistOD[9-i] <- mean(races[races$Year == (2024-i) & (races$Type == 'One-Day' | races$Race == 'Tour of Guangxi'),]$`Total Distance - WOMEN`)
  }
}
```


The same means are then calculated for the men's races:
```{r}
mMeanDist_df = data.frame(Year=c(2016:2024))
mMeanDist_df$DistStage = c(0)
mMeanDist_df$DistGT = c(0)
mMeanDist_df$DistOD = c(0)
mMeanDist_df$RaceCount = c(0)

for(i in 0:8) {
  mMeanDist_df$DistStage[9-i] <- mean(races[races$Year == (2024-i) & (races$Type == 'Stage' | races$Race == 'Tour of Guangxi'),]$`Total Distance - MEN`)
  mMeanDist_df$DistGT[9-i] <- mean(races[races$Year == (2024-i) & (races$Type == 'Grand Tour' | races$Race == 'La Vuelta de Espana'),]$`Total Distance - MEN`)
  mMeanDist_df$DistOD[9-i] <- mean(races[races$Year == (2024-i) & races$Type == 'One-Day',]$`Total Distance - MEN`)
    mMeanDist_df$RaceCount[9-i] <- nrow(races[races$Year == 2024-i,])
}
```

We then use this information to construct a sequence of bar charts:
```{r}
distances_matrix <- matrix(c(wMeanDist_df$DistOD, mMeanDist_df$DistOD), nrow = 2, byrow = TRUE)
rownames(distances_matrix) <- c("Womens", "Mens")
colnames(distances_matrix) <- wMeanDist_df$Year
barplot(distances_matrix, xlab="Year", ylab="Mean Distance (km)", main="Men and Women's One-Day Mean Distances", beside=TRUE, legend=c('Womens', 'Mens'), args.legend=list(x='bottomright'), col = c("lightblue", "lightcoral"))

distances_matrix <- matrix(c(wMeanDist_df$DistStage, mMeanDist_df$DistStage), nrow = 2, byrow = TRUE)
rownames(distances_matrix) <- c("Womens", "Mens")
colnames(distances_matrix) <- wMeanDist_df$Year
barplot(distances_matrix, xlab="Year", ylab="Mean Distance (km)", main="Men and Women's Stage Mean Distances", beside=TRUE, legend=c('Womens', 'Mens'), args.legend=list(x='bottomright'), col = c("lightblue", "lightcoral"))


distances_matrix <- matrix(c(wMeanDist_df$DistGT, mMeanDist_df$DistGT), nrow = 2, byrow = TRUE)
rownames(distances_matrix) <- c("Womens", "Mens")
colnames(distances_matrix) <- wMeanDist_df$Year
barplot(distances_matrix, xlab="Year", ylab="Mean Distance (km)", main="Men and Women's Grand Tour Mean Distances", beside=TRUE, legend=c('Womens', 'Mens'), args.legend=list(x='bottomright'), col = c("lightblue", "lightcoral"))
```
```{r}
scatterTemp <- races[races$Type == 'One-Day' | races$Type == "Grand Tour / women's one-day" | races$Type == "Men's stage, women's one-day", c('Year', 'Total Distance - WOMEN')]
scatterTemp$Gender <- 'Women'
colnames(scatterTemp) <- c("Year", "Total Distance", "Gender")

temp <- races[races$Type == 'One-Day', c('Year', 'Total Distance - MEN')]
temp$Gender <- 'Men'
colnames(temp) <- c("Year", "Total Distance", "Gender")

scatterTemp <- rbind(scatterTemp, temp)

colors <- c("lightcoral", "lightblue") 
plot(scatterTemp$Year, scatterTemp$`Total Distance`, col=colors[factor(scatterTemp$Gender)], pch = 19, xlab='Year', ylab='Total Distance (km)', main="One-Day Races Total Distances")
legend("bottomright", legend=c('Men', 'Women'), pch = 19, col=colors)
```

```{r}
scatterTemp <- races[races$Type == 'Stage', c('Year', 'Total Distance - WOMEN')]
scatterTemp$Gender <- 'Women'
colnames(scatterTemp) <- c("Year", "Total Distance", "Gender")

temp <- races[races$Type == 'Stage' | races$Race == 'Tour of Guangxi', c('Year', 'Total Distance - MEN')]
temp$Gender <- 'Men'
colnames(temp) <- c("Year", "Total Distance", "Gender")

scatterTemp <- rbind(scatterTemp, temp)

plot(scatterTemp$Year, scatterTemp$`Total Distance`, col=colors[factor(scatterTemp$Gender)], pch = 19, xlab='Year', ylab='Total Distance (km)', main="Stage Races Total Distances")
legend("topleft", legend=c('Men', 'Women'), pch = 19, col=colors)
```
```{r}
scatterTemp <- races[races$Type == 'Grand Tour', c('Year', 'Total Distance - WOMEN')]
scatterTemp$Gender <- 'Women'
colnames(scatterTemp) <- c("Year", "Total Distance", "Gender")

temp <- races[races$Type == 'Grand Tour' | races$Race == 'La Vuelta de Espana', c('Year', 'Total Distance - MEN')]
temp$Gender <- 'Men'
colnames(temp) <- c("Year", "Total Distance", "Gender")

scatterTemp <- rbind(scatterTemp, temp)

plot(scatterTemp$Year, scatterTemp$`Total Distance`, col=colors[factor(scatterTemp$Gender)], pch = 19, xlab='Year', ylab='Total Distance (km)', main="Grand Tour Races Total Distances")
legend("right", legend=c('Men', 'Women'), pch = 19, col=colors)
```


################################################################################
FOLLOWING CODE IS USED FOR GENERATING THE NUMBER OF TEAMS BAR CHARTS
################################################################################

First, the mean number of teams for each year for the women's races is calculated, with the data values being entered manually, and with the data being split between the different possible categories of races
```{r}
womenTeams2024Stage <- c(16, 20, 20, 18, 17)
womenTeams2024GrandTour <- c(21, 22, 22)
womenTeams2024OneDay <- c(16, 24, 24, 20, 24, 24, 24, 24, 24, 24, 18)

meanWomenTeams2024Stage <- mean(womenTeams2024Stage)
meanWomenTeams2024GrandTour <- mean(womenTeams2024GrandTour)
meanWomenTeams2024OneDay <- mean(womenTeams2024OneDay)

womenTeams2023Stage <- c(13, 20, 20, 19, 17)
womenTeams2023GrandTour <- c(23, 24, 22)
womenTeams2023OneDay <- c(12, 24, 24, 21, 24, 24, 24, 24, 24, 24, 18)

meanWomenTeams2023Stage <- mean(womenTeams2023Stage)
meanWomenTeams2023GrandTour <- mean(womenTeams2023GrandTour)
meanWomenTeams2023OneDay <- mean(womenTeams2023OneDay)

womenTeams2022Stage <- c(23, 22, 20)
womenTeams2022GrandTour <- c(23, 22, 22)
womenTeams2022OneDay <- c(24, 24, 23, 24, 24, 24, 24, 24, 24, 24)

meanWomenTeams2022Stage <- mean(womenTeams2022Stage)
meanWomenTeams2022GrandTour <- mean(womenTeams2022GrandTour)
meanWomenTeams2022OneDay <- mean(womenTeams2022OneDay)
```

Next, we find the same values for the men's races:
```{r}
menTeams2024Stage <- c(20, 20, 24, 24, 23, 19, 18)
menTeams2024GrandTour <- c(22, 22, 22)
menTeams2024OneDay <- c(13, 25, 25, 23, 25, 25, 25, 25, 25, 25)

menTeams2023Stage <- c(18, 20, 23, 23, 22)
menTeams2023GrandTour <- c(22, 22, 22)
menTeams2023OneDay <- c(14, 25, 25, 22, 25, 25, 25, 25, 25, 25)

menTeams2022Stage <- c(23, 22, 20)
menTeams2022GrandTour <- c(23, 22, 22)
menTeams2022OneDay <- c(25, 22, 24, 25, 24, 25, 25, 25, 25)
```

We then use this information to construct a sequence of bar charts:
```{r}

```


################################################################################
FOLLOWING CODE IS USED FOR GENERATING THE BOX PLOTS FOR THE INDIVIDUAL AND 
OVERALL PRIZE MONEY
################################################################################

First, we collect the data for the individual and overall prize money for the women's races, with these being separated by category:
```{r}
individualWomenPrizeMoney2024Stage <- c(12000, 12030, 16000)
individualWomenPrizeMoney2024GrandTour <- c(50000, 50000)
individualWomenPrizeMoney2024OneDay <- c(16000, 16000, 2256, 16000, 20000, 21000, 16000, 10000, 12500)

overallWomenPrizeMoney2024Stage <- c(100000, 100000, 130000)
overallWomenPrizeMoney2024GrandTour <- c(250000, 250000)
overallWomenPrizeMoney2024OneDay <- c(43000, 40000, 40000, 50000, 34000, 20000)
```

We then collect the same data for the men's races:
```{r}
individualMenPrizeMoney2024Stage <- c(12000, 35500, 12000, 16000, 12300, 20000)
individualMenPrizeMoney2024GrandTour <- c(150000, 265000, 500000)
individualMenPrizeMoney2024OneDay <- c(16000, 16000, 16000, 16000, 16000, 20000, 30000, 16000, 16000, 20000)

overallMenPrizeMoney2024Stage <- c(100000, 300000, 99000, 130000, 103700, 128000)
overallMenPrizeMoney2024GrandTour <- c(1119960, 1600000, 2573202)
overallMenPrizeMoney2024OneDay <- c(43000, 40000, 40000, 40000, 40000, 50000, 91000, 34000, 40000, 50000)
```





